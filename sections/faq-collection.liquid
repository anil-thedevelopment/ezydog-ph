<style>
  .list-section .container h2.Barlow-Medium.dfs-30.text-center.text-mb-sm {
    margin-top: 25px;
  }
  .list-section .container .justify-self-center {
    padding-top: 2em;
    margin-bottom: 30px;
  }
  .container h2.Barlow-Medium.dfs-30.text-center.text-mb-sm {
    margin: 1.5em 0;
  }
  .container {
    text-align: center;
  }
  .faq-content-wrapper .accordion__content .prose p {
    text-align: left;
  }
  .shopify-section:not(:has(.section-spacing))+.shopify-section {
    border-block-end-width: 1px;
  }
  .faq-content-wrapper .accordion__toggle {
    text-align: left;
  }
  .faq-content-wrapper .accordion__content li {
    text-align: left;
    margin-left: 15px;
  }
</style>

{% assign faq_questions = collection.metafields.custom.faq_question | parse_json | replace: '["' | replace: '"]' |split: '","' %}
{% assign faq_answers = collection.metafields.custom.faq_answer | parse_json | replace: '["' | replace: '"]' | split: '","' %}

  <section class="list-section">
    <div class="container">
      {% if faq_questions != blank %}
        <h2 class="Barlow-Medium dfs-30 text-center text-mb-sm">{{ section.settings.heading }}</h2>
      {% endif %}
      {% if faq_questions and faq_answers %}
        {% assign faq_length1 = faq_questions.size | minus: 1 %}
         <div class="faq-content-wrapper">
        {% for index1 in (0..faq_length1) %}
           <details class="accordion group" is="accordion-disclosure" aria-expanded="true" style="">
              <summary class="">
                <h3 class="accordion__toggle text-lg">
                  <b class="text-with-icon gap-4 accordion-heading Barlow dfs-16 mfs-14 faq-question">{{ faq_questions[index1] }}</b>
                  <span class="animated-plus group-expanded:rotate" aria-hidden="true"></span>
                </h3>
              </summary>
            
              <div class="accordion__content Barlow" style="opacity: 1; transform: translateY(0px);">
                <div class="prose">
                  <p class="faq-answer">{{ faq_answers[index1] }}</p>
                </div>
              </div>
            </details>
        {% endfor %}
         </div>
      {% endif %}
    </div>
  </section>

<style>
  .justify-self-center .button:hover {
    background: rgb(var(--button-background, var(--button-background-primary))) !important;
    color: #fff !important;
  }
</style>

<script>
  $(document).ready(function () {
    var $faqItems = $(".faq-content-wrapper .accordion");
    var totalItems = $faqItems.length;

    if (totalItems > 3) {
      $faqItems.slice(3).hide();

      $('<div class="justify-self-center" style="margin-top: 20px;">' +
          '<a class="button read-more-btn" href="#">Show More</a>' +
          '</div>').insertAfter(".faq-content-wrapper");

      $("body").on("click", ".read-more-btn", function (event) {
        event.preventDefault();
        $faqItems.slice(3).slideDown();
        $(this).text("Show Less").addClass("read-less-btn").removeClass("read-more-btn");
      });

      $("body").on("click", ".read-less-btn", function (event) {
        event.preventDefault();
        $faqItems.slice(3).slideUp();
        $(this).text("Show More").addClass("read-more-btn").removeClass("read-less-btn");
      });
    }
  });
</script>

<!-- FAQ Schema -->
{% if faq_questions and faq_answers and faq_questions.size > 0 and faq_answers.size > 0 %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {% assign faq_length = faq_questions.size | minus: 1 %}
      {% for index in (0..faq_length) %}
      {
        "@type": "Question",
        "name": {{ faq_questions[index] | json }},
        "acceptedAnswer": {
          "@type": "Answer",
          "text": {{ faq_answers[index] | replace: ';', ',' | json }}
        }
      }{% if forloop.last == false %},{% endif %}
      {% endfor %}
    ]
  }
  </script>
{% endif %}


{% schema %}
{
  "name": "FAQ Collection",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Frequently Asked Questions"
    }
  ],
  "blocks": [],
  "presets": [
    {
      "name": "FAQ Collection",
      "category": "Custom"
    }
  ]
}
{% endschema %}
